namespace cds.xt;

entity Tenants {
    key ID       : String;
        metadata : String;
}

entity Jobs {
    key ID        : String; // REVISIT: cuid from cds/common?
        status    : String(20) default 'processing';
        op        : String;
        result    : LargeString;
        createdAt : Timestamp @cds.on.insert : $now;
        tasks     : Composition of many Tasks on tasks.job = $self;
}

entity Tasks {
    key job       : Association to Jobs;
    key ID        : String; // REVISIT: cuid from cds/common?
        tenant    : String(100);
        op        : String;
        status    : String(20) default 'processing';
        createdAt : Timestamp @cds.on.insert : $now;
        database  : String;
}

type Status : String enum {
    QUEUED;
    RUNNING;
    FINISHED;
    FAILED;
}
